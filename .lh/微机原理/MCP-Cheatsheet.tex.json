{
    "sourceFile": "微机原理/MCP-Cheatsheet.tex",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 0,
            "patches": [
                {
                    "date": 1767155321468,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                }
            ],
            "date": 1767155321468,
            "name": "Commit-0",
            "content": "\\documentclass[10pt, a4paper, landscape]{article}\n\n% -------------------------------------------------\n% 宏包引入\n% -------------------------------------------------\n\\usepackage[fontset=mac]{ctex}       % 中文支持\n\\usepackage{multicol}   % 多分栏\n\\usepackage{calc}\n\\usepackage{ifthen}\n\\usepackage[landscape]{geometry} % 页面设置\n\\usepackage{amsmath,amsthm,amsfonts,amssymb} % 数学公式\n\\usepackage{color,graphicx,overpic} % 颜色与图片\n\\usepackage{hyperref}   % 超链接\n\\usepackage{enumitem}   % 列表环境控制\n\\usepackage{titlesec}   % 标题控制\n\\usepackage{bm}         % 加粗数学符号\n\\usepackage{xcolor}\n\\usepackage{tikz}       % 绘图\n\\usetikzlibrary{decorations.pathreplacing, positioning} % 加载brace装饰库\n\\setCJKmainfont{PingFang SC}\n\\setCJKsansfont{PingFang SC}\n\\setCJKmonofont{PingFang SC}\n\n% -------------------------------------------------\n% 自定义颜色\n% -------------------------------------------------\n\n\\definecolor{myblue}{HTML}{003153} % 蓝色字\n\\definecolor{myred}{HTML}{85120F}  % 红色字\n\\definecolor{hlblue}{HTML}{7090D3} % 蓝色高亮\n\\definecolor{hlred}{HTML}{D66A83}  % 红色高亮\n\\definecolor{hlyellow}{HTML}{E3C79F}  % 奢金高亮\n\\definecolor{hlgreen}{HTML}{BED49D}  % 抹茶绿高亮\n\n% -------------------------------------------------\n% 极限空间压缩设置 (核心部分)\n% -------------------------------------------------\n\n% 1. 页边距设置为极小 (0.5cm)\n\\geometry{top=0.5cm,left=0.5cm,right=0.5cm,bottom=0.5cm}\n\n% 2. 去掉段落首行缩进，改为段落间略微留空（可选，这里为了紧凑设为0）\n\\setlength{\\parindent}{0pt}\n\\setlength{\\parskip}{0pt}\n\n% 3. 设置正文基础字体大小为 scriptsize (约8pt)，如果还觉得大，可以改为 \\tiny\n\\renewcommand{\\baselinestretch}{0.9} % 压缩行间距\n\\let\\oldfootnotesize\\footnotesize\n\\renewcommand{\\footnotesize}{\\fontsize{7pt}{8pt}\\selectfont}\n\n% 4. 压缩列表环境 (Itemize/Enumerate) 的间距\n\\setlist{nolistsep} \n\\setlist[itemize]{leftmargin=*}\n\\setlist[enumerate]{leftmargin=*}\n\n% 5. 压缩标题间距\n\\titleformat{\\section}{\\bfseries\\scriptsize\\color{myblue}}{}{0em}{}[\\hrule] % 标题带下划线，蓝色，省空间\n\\titlespacing*{\\section}{0pt}{2pt}{1pt} % 上方留2pt，下方留1pt\n\\titleformat{\\subsection}\n    [runin] % 不换行\n    {\\bfseries\\scriptsize} % 粗体、scriptsize，黑色字体\n    {} % 不显示编号\n    {0pt} % 标题与正文间距\n    {\\hlyellow} % 用hlyellow高亮命令包裹标题\n    [] % 标题内容后无内容\n\\titleformat{\\subsubsection}\n    [runin] % 不换行\n    {\\bfseries\\tiny} % 粗体、scriptsize，黑色字体\n    {} % 不显示编号\n    {0pt} % 标题与正文间距\n    {\\hlgreen} % 用hlgreen高亮命令包裹标题\n    [] % 标题内容后无内容\n\\titlespacing*{\\subsection}{0pt}{1pt}{0.5em} % 上方1pt,下方0.5em(水平间距)\n\\titlespacing*{\\subsubsection}{0pt}{1pt}{0.5em} % 上方1pt,下方0.5em(水平间距)\n\n% -------------------------------------------------\n% 自定义命令\n% -------------------------------------------------\n% 颜色字\n\\newcommand{\\red}[1]{\\textbf{\\textcolor{myred}{#1}}}  \n\\newcommand{\\blue}[1]{\\textbf{\\textcolor{myblue}{#1}}} \n\\newcommand{\\entry}[2]{$\\bullet$ \\textbf{#1}: #2\\par\\vspace{0.5pt}}\n% 高亮\n\\newcommand{\\cbox}[2][yellow]{\\begingroup\\setlength{\\fboxsep}{1pt}\\colorbox{#1}{\\strut#2}\\endgroup}\n\\newcommand{\\hlblue}[1]{\\cbox[hlblue]{#1}}\n\\newcommand{\\hlred}[1]{\\cbox[hlred]{#1}}\n\\newcommand{\\hlyellow}[1]{\\cbox[hlyellow]{#1}}\n\\newcommand{\\hlgreen}[1]{\\cbox[hlgreen]{#1}} \n% 图片插入\n\\newcommand{\\img}[2][0.9\\linewidth]{%\n    {\\par\\vspace{1pt}\\centering\\includegraphics[width=#1]{#2}\\par\\vspace{1pt}}%\n}\n% 左图右文 (参数: [图片宽度比例]{图片路径}{右侧文字内容})\n\\newcommand{\\imgleft}[3][0.3]{%\n    \\noindent\\begin{minipage}[t]{#1\\linewidth}%\n        \\vspace{0pt}%\n        \\includegraphics[width=\\linewidth]{#2}%\n    \\end{minipage}%\n    \\hfill%\n    \\begin{minipage}[t]{0.98\\linewidth - #1\\linewidth}%\n        \\vspace{0pt}%\n        #3%\n    \\end{minipage}\\par\\vspace{2pt}%\n}\n% 左文右图 (参数: [图片宽度比例]{图片路径}{左侧文字内容})\n\\newcommand{\\imgright}[3][0.3]{%\n    \\noindent\\begin{minipage}[t]{0.98\\linewidth - #1\\linewidth}%\n        \\vspace{0pt}%\n        #3%\n    \\end{minipage}%\n    \\hfill%\n    \\begin{minipage}[t]{#1\\linewidth}%\n        \\vspace{0pt}%\n        \\includegraphics[width=\\linewidth]{#2}%\n    \\end{minipage}\\par\\vspace{2pt}%\n}\n% -------------------------------------------------\n% 新增：概念速查表专用命令\n% -------------------------------------------------\n% 表格容器\n\\newcommand{\\concepttable}[1]{%\n    {\\setlength{\\tabcolsep}{1.5pt}% 局部减小列间距\n     \\renewcommand{\\arraystretch}{0.92}% 局部紧缩行距\n     \\par\\vspace{2pt}{\\color{myblue}\\hrule height 0.6pt}\\vspace{1pt}% 上边框(蓝色,0.6pt粗)\n     \\noindent\\begin{tabular}{@{}p{0.22\\linewidth}p{0.76\\linewidth}@{}}%\n     #1%\n     \\end{tabular}%\n     \\vspace{1pt}{\\color{myblue}\\hrule height 0.6pt}\\par\\vspace{2pt}}% 下边框(蓝色,0.6pt粗)\n}\n% 表格行 (参数: {概念名}{解释})\n\\newcommand{\\conrow}[2]{\\blue{#1} & #2 \\\\}\n\n\n\n\n% -------------------------------------------------\n% 正文\n% -------------------------------------------------\n\\begin{document}\n\n\\tiny\n\n% 三栏布局\n\\begin{multicols*}{3}\n\n\\section{第一章\\ 微机概述}\n\\entry{地址引脚数}{为 \\red{16 条}，可以寻址 \\red{$2^{16}=64$KB} 的存储单元。\\red{$2^{10}=1$K}，\\red{$2^{20}=1$M}，\\red{$2^{30}=1$G}；\\red{b} 表示位，\\red{B} 表示字节。}\n\\entry{补码}{补码为原码取反加 1，最高位 \\red{1} 表示负数，\\red{0} 表示正数。例：\\red{[-89]补=10100111}。十六进制数后面要加 \\red{H}，否则默认十进制。}\n\n\\concepttable{\n    \\conrow{微处理器}{微型计算机中用 \\red{CPU} 表示，由一片或几片大规模集成电路组成，具有\\red{运算和控制器功能}的中央处理器部件。}\n    \\conrow{微型计算机}{以\\red{微处理器}为核心，配上\\red{存储器}、\\red{输入输出接口电路}及\\red{系统总线}组成，又称\\red{主机}。}\n    \\conrow{微型计算机系统}{以\\red{微型计算机}为中心，配以外围设备、电源和辅助电路（硬件系统），以及指挥工作的\\red{软件系统}。}\n    \\conrow{软件系统}{包括：\\red{系统软件}（操作系统、编译器、数据库等）和\\red{应用软件}（Office、微信等）。}\n}\n\n\\entry{典型微机硬件系统结构}{\n    计算机的经典结构为\\red{冯·诺依曼结构}（\\red{存储程序式计算机}结构），特点包括：由\\red{运算器}、\\red{控制器}、\\red{存储器}、\\red{输入设备}和\\red{输出设备}五个基本部分组成；\\red{程序和数据以二进制代码形式存放在存储器中}，位置由\\red{地址}指定，地址码也是二进制；\\red{控制器}根据存储器中的\\red{指令序列（程序）}工作，并由\\red{程序计数器（PC）}控制指令执行，具有判断能力，可根据计算结果选择不同动作流程。\\red{微处理器}是执行指令的核心部件，包含\\red{运算器}和\\red{控制器}。\\red{存储器}用于存储当前正在使用的程序和数据。\\red{I/O 设备和接口}实现微处理器与外部设备的连接，如\\red{显示器接口}、\\red{硬盘接口}等。\\red{系统总线}连接微处理器和其他部件，分为\\red{地址总线}、\\red{数据总线}和\\red{控制总线}，分别传输地址、数据和控制信息。\n}\n\\imgleft[0.3]{images/image-2025-12-30-15-59-39.png}{\n    \\entry{总线}{\n        \\red{CPU}通过总线读取指令，与\\red{内存}、\\red{外设}之间进行数据交换。在\\red{CPU}、\\red{内存}和\\red{外设}确定的情况下，\\red{总线速度}是制约计算机整体性能的关键。\\red{总线}是一组传输公共信息的信号线集合，是各部件之间传输\\red{地址}、\\red{数据}和\\red{控制信息}的公共通道。处理器内部、处理器与高速缓冲器及内存之间、处理器与外围设备之间，均通过总线连接。根据结构组织方式不同，总线分为：\\red{单总线结构}、\\red{双总线结构}、\\red{双重总线结构}（\\red{80X86系统采用}，\\red{局部总线}用于CPU访问局部存储器和局部I/O，\\red{全局总线}用于CPU访问全局存储器和全局I/O，由\\red{总线控制逻辑}统一安排，实现\\red{并行操作}，提高系统数据处理和传输效率）。\n    }\n}\n\n\\subsection{数制与计算}\n\n\\entry{有符号数的机器表示}{\n    \\blue{真值}指带正负号的实际数值（如 $+5, -5$），而\\blue{机器数}是计算机内部存储的编码形式。有符号数常用三种标准编码：\n    \\begin{itemize}\n        \\item \\blue{原码}：$[X]_{\\text{原}}$\n        \\item \\blue{反码}：$[X]_{\\text{反}}$\n        \\item \\blue{补码}：$[X]_{\\text{补}}$\n    \\end{itemize}\n}\n\n\\entry{正负数的编码差异}{\n    \\blue{正数}：三种表示法完全一致，即 $[X]_{\\text{原}} = [X]_{\\text{反}} = [X]_{\\text{补}}$，符号位为 $0$，数值位直接表示绝对值。\n    \\blue{负数}：三种表示法存在差异，所有区别仅体现在负数的编码规则上。\n}\n\n\\entry{补码的主导地位}{\n    \\red{现代计算机均采用补码}。补码便于硬件实现加减法，成为实际工程标准。\n}\n\n\\entry{补码加减法运算规则}{\n    \\blue{核心思想}：\\red{减法变加法}，即 $X-Y$ 可转化为 $X+(-Y)$，简化硬件设计。\n    \\begin{itemize}\n        \\item \\blue{加法}：$[X+Y]_{\\text{补}} = [X]_{\\text{补}} + [Y]_{\\text{补}}$\n        \\item \\blue{减法}：$[X-Y]_{\\text{补}} = [X]_{\\text{补}} - [Y]_{\\text{补}} = [X]_{\\text{补}} + [-Y]_{\\text{补}}$\n    \\end{itemize}\n    \\blue{符号位参与运算}：补码加法时，符号位与数值位同等对待，全部参与二进制加法（逢二进一）。\n}\n\n\\entry{补码求负（变补规则）}{\n    $[-X]_{\\text{补}}$ 的求法：将 $[X]_{\\text{补}}$ 的\\red{所有位（包括符号位）按位取反，再加 $1$}。即“全字取反加一”。\n    \\blue{注意}：\\red{包括符号位}，不区分符号和数值位。\n}\n\n\\section{第二章\\ 微机结构}\n\n\\imgleft[0.4]{images/image-2025-12-28-22-49-19.png}{\n\n    \\entry{8086/8088 对比}{\n        \\red{8086}：16 位外部数据总线；\\red{8088}：8 位外部数据总线（准 16 位），为兼容 8 位外设。\n        两者均为 \\red{20 位} 地址线（寻址 \\red{1MB}），I/O 寻址 \\red{16 位}（\\red{64KB}）。\n    }\n\n    \\concepttable{\n        \\conrow{BIU (总线接口)}{负责\\red{取指}、\\red{总线操作}、\\red{物理地址形成}。含指令队列、段寄存器（CS/DS/ES/SS）、IP、地址加法器。}\n        \\conrow{EU (执行单元)}{负责\\red{译码}、\\red{执行}、\\red{运算}。含 ALU、通用寄存器、标志寄存器、控制电路。}\n        \\conrow{并行工作}{BIU 取指与 EU 执行重叠，实现流水线雏形，提高总线利用率。}\n    }\n\n}\n\n\\entry{物理地址计算}{\n    $PA = \\text{段基址} \\times 10H + \\text{偏移地址}$。\n    段基址由\\red{段寄存器}（16位）左移 4 位提供，偏移地址由 \\red{IP} 或 \\red{EU} 计算。\n}\n\n\\concepttable{\n    \\conrow{指令队列}{8086 为 \\red{6 字节}，8088 为 \\red{4 字节}。FIFO 原则。当队列空出 2 字节(8086)或 1 字节(8088)时，BIU 自动取指。执行跳转/调用/返回时\\red{清空}。}\n    \\conrow{通用寄存器}{AX (累加器), BX (基址), CX (计数), DX (数据)。可拆分为 H/L 8 位使用。}\n    \\conrow{指针与变址}{SP (堆栈指针), BP (基址指针), SI (源变址), DI (目的变址)。}\n}\n\n\n% --- 第2部分：列表压缩测试 ---\n\\section{第三章\\ 80x86 指令系统}\n\n\\subsection{寻址方式}\n\n需要看清楚问的是源操作数还是目标操作数的寻址方式，如果是字操作数，要写两个单元的地址。\n\n\\concepttable{\n    \\conrow{固定寻址}{如 \\red{AAA}}\n    \\conrow{立即数寻址}{操作数直接包含在指令中。举例 \\red{MOV AL,15H || MOV AX,1234H}}\n    \\conrow{寄存器寻址}{操作数在寄存器中。例：\\red{MOV AX, BX}}\n    \\conrow{存储器寻址}{比较复杂，见下文详细说明。}\n}\n\n\\entry{存储器寻址}{\n    当执行单元 \\red{EU} 需要读/写位于存储器的操作数时，应根据指令给出的寻址方式，由 \\red{EU} 先计算出操作数的有效地址 \\red{$EA$}(偏移地址)，并将它送给 \\red{BIU}；同时请求 \\red{BIU} 执行一个总线周期，\\red{BIU} 将某个段寄存器的内容左移 4 位，加上 \\red{EU} 送来的有效地址 \\red{$EA$} 形成 20 位的物理地址，然后执行总线周期，读/写指令所需的操作数。有效地址 \\red{$EA$}(偏移地址) 的值要根据指令所采用的寻址方式计算得出。计算 \\red{$EA$} 的通式为：\n}\n\\vspace{-8pt}\n{\\setlength{\\abovedisplayskip}{0pt}\n\\setlength{\\belowdisplayskip}{0pt}\n\\[\n\\boxed{\nEA = \\text{基址值} \\left\\{\n\\begin{array} { l }\n{ BX } \\\\\n{ BP }\n\\end{array}\n\\right. +\n\\text{变址值} \\left\\{\n\\begin{array} { l }\n{ SI } \\\\\n{ DI }\n\\end{array}\n\\right. +\n\\text{位移量} \\left\\{\n\\begin{array} { l }\n{ 0 } \\\\\n{ 8 } \\\\\n{ 16 }\n\\end{array}\n\\right\\}\n}\n\\]}\n\\vspace{-8pt}\n\n\\concepttable{\n    \\conrow{直接寻址}{操作数的 $EA$ 由指令直接给出。段地址默认数据段 \\red{DS}，其它数据段应在指令中用段前缀指出。这种寻址方式的指令执行速度较快，主要用于存取位于存储器中的简单变量。例：\\red{MOV AX, [1234H]}}\n    \\conrow{间接寻址}{操作数在存储器中，\\red{存储单元的有效地址由寄存器指出}。\\par\n    \\red{BX、SI、DI} — 默认数据段 \\red{DS}\\par\n    \\red{BP} — 默认堆栈段 \\red{SS}，\\par\n    \\blue{注意}：间接寻址的地址寄存器只能是 \\red{BX、BP、SI、DI}，不能是其它寄存器。指令中地址寄存器要加方括号, 如: \\red{[BX]}。根据所采用的地址寄存器的不同，间接寻址方式又可分为以下 3 种：}\n}\n\n\\concepttable{\n    \\conrow{基址寻址}{操作数的有效地址由基址寄存器 (\\red{BX} 或 \\red{BP}) 的内容和指令中给出的地址位移量 ($0$ 位或 $8$ 位或 $16$ 位) 之和来确定。$EA = BX/BP + 0 \\text{位}/8 \\text{位}/16 \\text{位移量}$。例：\\red{MOV AX, [BX]}，假设 $BX = 1122H, DS = 3000H$，则 $PA = 30000H + 1122H = 31122H, 30000H + 1123H = 31123H$。假设 $[31122H] = 34H, [31123H] = 56H$，则指令执行后，\\red{AX = 5634H}。例：假设 $BETA=8, DS=6000H, BX=5000H$，则 \\red{MOV AL, [BX+8]} || \\red{MOV AL, 8[BX]}；“8”是偏移地址位移量，不是乘的倍数 || \\red{MOV AL, [BX+BETA]} || \\red{MOV AL, BETA [BX]}。注：上面 4 条指令是等价的。$EA = 5000H+8= 5008H, PA = DS \\times 16+5008H= 60000H+5008H= 65008H$。假设 $[65008H]=68H$，执行后，\\red{AL=68H}}\n    \\conrow{变址寻址}{操作数的有效地址由变址寄存器 (\\red{SI} 或 \\red{DI}) 的内容与指令中给出的地址位移量 ($0$ 位、$8$ 位或 $16$ 位) 之和来确定。$EA$（偏移地址）$= SI/DI + 0 \\text{位}/8 \\text{位}/16 \\text{位移量}$。例：\\red{MOV BETA[DI], AX} || \\red{MOV BX, [SI+BETA]}}\n    \\conrow{基址加变址}{操作数的有效地址 $EA$ 为以下三部分之和：基址寄存器 (\\red{BX} 或 \\red{BP}) 的值、变址寄存器 (\\red{SI} 或 \\red{DI}) 的值、指令中的地址位移量 ($0$ 位、$8$ 位或 $16$ 位)。$EA = [BX/BP] + [SI/DI] + 0/8/16 \\text{位偏移量}$。例: \\red{MOV BX, [BX+SI]} || \\red{MOV [BX][DI], AX} || \\red{MOV AX, 8[BX][SI]} || \\red{MOV AX, 8[BX+SI]} || \\red{MOV AX, [BX+SI+8]} || \\red{MOV AX, ES:[BX+SI+10H]} “ES:”---段前缀，指定操作数在附加段，源操作数 $PA = ES \\times 16+ BX+SI+10H, ES \\times 16+ BX+SI+10H+1$ || \\red{MOV AX, [BP+SI+20H]} \\red{BP}---操作数在堆栈段，源操作数 $PA = SS \\times 16+ BP+SI+20H, SS \\times 16+ BP+SI+20H+1$}\n}\n\n\n% --- 第3部分：图表占位 ---\n\\section{第四章 汇编语言程序设计基础}\n\\red{注意}：如果有图片，尽量不要插入大图。建议手绘或者用 TikZ，或者只是文字描述流程。\n\n% --- 模拟填充内容以展示三栏效果 ---\n\\section{第五章 微机总线技术}\n\n\\subsection{概念}\n\n\\entry{总线定义}{\n    总线是用来\\red{连接各部件的一组通信线}。换言之，总线是一种在多于两个模块（设备或子系统）间传送信息的公共通路。为在各模块之间实现信息共享和交换，总线由传送信息的物理介质以及一套管理信息传输的协议构成。\n}\n\\entry{三态逻辑}{除了逻辑 0 和逻辑 1 之外，还有第三种状态——高阻态（Hi-Z）。高阻态相当于断开电路，使得该信号线不对总线产生影响，从而允许其他设备驱动总线。}\n\n\\entry{微机总线分类}{\n按功能可分为\\red{系统总线（内总线）}和\\red{通信总线（外总线）}；按信号传输方式可分为\\red{串行总线}与\\red{并行总线}。\n}\n\n\\concepttable{\n    \\conrow{片内总线}{又称元件级总线，位于\\red{集成电路芯片内部}，连接芯片内各功能单元}\n    \\conrow{片总线}{连接同一块插件板（PCB）上各个芯片的总线，常见如\\red{IIC 总线}、\\red{SPI 总线}等。}\n    \\conrow{\\red{内总线}}{又称系统总线、板级总线或微机总线，用于微机系统中各插件之间的信息传输。是我们主要研究的总线类型}\n    \\conrow{外总线}{又称通信总线，常见如\\red{USB}、\\red{PCIe}、\\red{SATA}等。}\n}\n\n\\concepttable{\n    \\conrow{数据总线}{\\blue{双向数据线}，是一个总线周期内可以传送的数据位数，}\n    \\conrow{地址总线}{\\blue{单向地址线}（通常为三态逻辑控制），位宽如\\red{16、20 等}， 位宽代表了芯片的寻址能力（20位地址线意味着$2^{20}$的寻址能力）。}\n    \\conrow{控制总线}{传送定时与控制信号以协调各部件动作（如读/写、中断请求、复位等），控制总线一般\\red{不采用三态逻辑}。}\n}\n\n\n\\concepttable{\n    \\conrow{总线宽度}{即数据总线的位数，决定了\\red{一个总线周期内可并行传输的数据位数}。}\n    \\conrow{总线频率}{总线的工作时钟频率（单位为 Hz），表示\\red{每秒总线可执行的数据传输次数}。}\n    \\conrow{传输速率}{衡量总线性能的最终指标，表示\\red{单位时间内总线可传输的数据总量}（单位为 MB/s）。三者关系：$\\text{传输速率} = (\\text{总线宽度}/8) \\times \\text{总线频率}$。}\n}\n\\subsection{常用芯片}\n\\entry{常用缓冲器芯片}{\\red{74LS245}（双向总线收发器）、\\red{74LS244}（单向三态缓冲器）、\\red{74LS373}（八位透明锁存器）、\\red{74LS138}（3-8 线译码器）、\\red{74LS157}（4-1 线数据选择器）等。}\n\n\\entry{74LS244}{\\red{单向三态缓冲器}，8 路分为两组\\red{两个使能端均为低电平有效}。常用于数据总线的缓冲与隔离。\n}\n\\concepttable{\n    \\conrow{$1A1$--$1A4$}{$1Y1$--$1Y4$（由 $1G$ 控制）}\n    \\conrow{$2A1$--$2A4$}{$2Y1$--$2Y4$（由 $2G$ 控制）}\n}\n    \n\n\\entry{74LS245}{\n    又称\\red{收发器}。在\\red{A 端}和\\red{B 端}之间，\\red{并联了两个方向相反的单向三态门}。拥有两个控制信号：\n}\n\\concepttable{\n    \\conrow{E}{\\red{全局使能信号}，决定整个双向通道是否工作或处于高阻态，\\red{低电平有效}。}\n    \\conrow{DIR}{\\red{方向控制信号}，在通道被 $E$ 使能时，选择数据是 $A\\rightarrow B$ 还是 $B\\rightarrow A$ 传输。}\n}\n\n\\entry{74LS373}{\n    由两个独立逻辑单元组成：\n}\n\\concepttable{\n    \\conrow{D型锁存器}{\\red{存储/保持数据}（由\\red{G}控制）。使能时，锁存器处于\\red{透明}状态，输出\\red{1Q}跟随输入\\red{1D}的逻辑电平变化；非使能时，锁存器被关闭，\\red{保存上一瞬间1D上的逻辑状态}。}\n    \\conrow{三态输出门}{负责控制数据是否被驱动到输出总线（由\\red{OE}控制，使能时传输，否则为\\red{高阻态}）。}\n}\n\\subsection{引脚复用}\n\n8086 一共的40个引脚不足以承载20位地址总线和16位数据总线及其他的控制线\n\n\\concepttable{\n    \\conrow{AD0--AD15}{\\red{地址/数据复用总线}。在总线周期的 T1，传递地址总线低 $16$ 位（$A_0$--$A_{15}$）；在 T2--T4，转而用作数据总线（$D_0$--$D_{15}$）。}\n    \\conrow{A16/S3--A19/S6}{\\red{地址/状态复用总线}。在总线周期的 T1，传送地址总线高 $4$ 位（$A_{16}$--$A_{19}$，构成 $20$ 位完整地址）；在 T2--T4，转而输出 CPU 的内部状态信号（$S_3$--$S_6$）。}\n}\n\\subsection{工作模式}\n\n即使复用了地址和数据总线，剩余的引脚仍不足以同时支持简单系统。\n\n\\concepttable{\n    \\conrow{最小方式}{\n        $\\mathrm{MN/MX\\#}$ 连接到高电平（$\\mathrm{V_{CC}}$）时激活。CPU自行产生总线控制信号（直接输出控制信号，如 $\\mathrm{INTA\\#}$、$\\mathrm{ALE}$、$\\mathrm{RD\\#}$、$\\mathrm{WR\\#}$、$\\mathrm{M/IO\\#}$ 等）。适用于\\red{单处理器系统}，CPU直接控制总线，无需外部总线控制器。\n    }\n    \\conrow{最大方式（Maximum Mode）}{\n        $\\mathrm{MN/MX\\#}$ 连接到低电平（$\\mathrm{GND}$）时激活。CPU不直接产生控制信号，而是输出编码后的状态信号。引脚24-31被重定义：\n    }\n}\n\n\\concepttable{\n    \\conrow{$\\mathrm{S0\\#}$、$\\mathrm{S1\\#}$、$\\mathrm{S2\\#}$}{输出状态，需外接 8288 解码生成 $\\mathrm{RD\\#}$、$\\mathrm{WR\\#}$、$\\mathrm{ALE}$ 等}\n    \\conrow{$\\mathrm{RQ\\#/GT0\\#}$、$\\mathrm{RQ\\#/GT1\\#}$}{请求/准许信号，用于总线仲裁}\n    \\conrow{$\\mathrm{LOCK\\#}$}{总线锁定信号，保证原子操作，适用于多处理器系统}\n}\n\n\\subsection{总线时序}\n\n\\subsubsection{名词解释}\n 一个基本的总线周期需要\\red{至少4个时钟周期}（即4个T状态，通常标记为T1, T2, T3, T4）。\n\\concepttable{\n    \\conrow{时序}{信息在总线上的出现不仅要有\\red{空间顺序}，还要有\\red{严格的顺序和准确的时间}。这种时间和逻辑上的配合关系被称为时序。}\n    \\conrow{时钟}{由时钟发生器产生的具有固定频率和占空比的脉冲序列。是整个微机系统的时间基准，所有部件的动作都必须与此信号同步。}\n    \\conrow{主频}{时钟的频率，衡量 CPU 处理速度的一个指标。}\n    \\conrow{时钟周期}{主频的倒数（$T = 1/f$）。}\n    \\conrow{总线周期}{CPU 通过总线对存储器或 I/O 端口进行\\red{一次完整的访问（读或写）所需的时间}。}\n}\n\n\\subsubsection{常用信号}\n\n除了CLK外的常用控制信号包括：\n\n\\concepttable{\n    \\conrow{M/IO}{\\red{存储器/I/O 控制信号}，用于区分 CPU 是访问存储器（$M/IO=1$）还是访问 I/O 端口（$M/IO=0$）。}\n    \\conrow{DT/R\\#}{\\red{数据发送/接收信号}，在 $T_1$ 周期用于指示 245 等数据缓冲芯片的传输方向。}\n    \\conrow{RD\\#}{\\red{读控制信号}。$RD$ 信号为低电平时，表示 8086 CPU 执行读操作。在 DMA 方式时，$RD$ 处于高阻态。}\n    \\conrow{WR\\#}{\\red{写控制信号}（输出，三态）。当 8086 CPU 对存储器或 I/O 端口进行写操作时，$WR$ 为低电平。}\n    \\conrow{ALE}{\\red{地址锁存允许信号}（输出）。8086 CPU 在总线周期的第一个时钟周期内发出的正脉冲信号，其下降沿用来把地址/数据总线（$AD_{15}\\sim AD_{0}$）以及地址/状态总线（$A_{19}/S_{6}\\sim A_{16}/S_{3}$）中的地址信息锁住存入地址锁存器中。}\n    \\conrow{DEN\\#}{\\red{数据缓冲器使能信号}}\n    \\conrow{BHE\\#/S7}{\\red{总线高允许/状态 $S_7$ 信号}。分时复用的双重总线，在总线周期开始的 $T_1$ 周期，作为总线高半部分允许信号，低电平有效。在总线周期的其他 $T$ 周期，该引脚输出状态信号 $S_7$。在 DMA 方式下，该引脚为高阻态。}\n}\n\n\\concepttable{\n    \\conrow{BHE\\#}{总线高允许信号，低电平有效。用于控制数据总线高 8 位（D15--D8）的读写。}\n    \\conrow{A0}{地址最低位，访问偶地址时，A0 必然为 0。}\n}\n\n奇偶地址访问方式：\n\n\\concepttable{\n    \\conrow{BHE\\#=0, A0=0}{访问\\red{16 位偶地址}（全字访问），数据线 D15--D0 全部有效。}\n    \\conrow{BHE\\#=1, A0=0}{访问\\red{8 位偶地址}，仅 D7--D0 有效（低字节）。}\n    \\conrow{BHE\\#=0, A0=1}{访问\\red{8 位奇地址}，仅 D15--D8 有效（高字节）。}\n    \\conrow{BHE\\#=1, A0=1}{无效访问（不选中任何字节）。}\n}\n\n\\subsubsection{复位、启动时序}\n\n\\entry{RESET 信号}{需保持高电平至少 \\red{4 个时钟周期}。有效期间总线处于\\red{高阻态}（浮空）。}\n\n\\imgleft[0.3]{images/image-2025-12-28-20-26-42.png}{\n\n\\concepttable{\n    \\conrow{CS : IP}{\\red{FFFFH : 0000H}（启动地址 \\red{FFFF0H}）}\n    \\conrow{标志位}{\\red{IF=1}（允许中断），其余清零}\n    \\conrow{DS/SS/ES}{\\red{0000H}}\n    \\conrow{指令队列}{清空}\n    }\n}\n\n\\entry{复位执行流}{\n    CPU 复位后 \\red{CS:IP = FFFFH:0000H} (物理地址 \\red{FFFF0H})。从该处取出 \\red{JMP} 指令，跳转至低地址空间的系统初始化程序（如 BIOS）。\n    \\red{原因}：从 \\red{FFFF0H} 到内存顶端 \\red{FFFFFH} 仅剩 \\red{16 字节}，空间极小，无法容纳完整程序。\n}\n\n\\subsubsection{最小方式总线读操作时序}\n\n8086 CPU需要与外部存储器或I/O端口交换数据，或者需要填充指令队列时，必须执行一个总线周期（四个或更多时钟周期，考虑到 $T_W$ 的存在）。\n\n\\imgleft[0.5]{images/image-2025-12-28-20-30-45.png}{\n\n\\concepttable{\n    \\conrow{T1}{确定 $M/\\overline{IO}$ 状态；输出地址信息；$ALE$ 发出正脉冲（下降沿锁存地址）；$DT/\\overline{R}$ 置低（接收）。}\n    \\conrow{T2}{$AD_{15}\\sim AD_0$ 进入高阻态；$\\overline{RD}$ 与 $\\overline{DEN}$ 有效（低电平）；输出状态信号 $S_3\\sim S_7$。}\n    \\conrow{T3}{外设将数据驱动至总线。在 $T_3$ 前沿采样 $READY$ 信号，若为 0 则插入等待周期 $T_W$。}\n    \\conrow{T4}{在 $T_4$ 前沿（即 $T_3/T_W$ 结束处）采样数据；撤销 $\\overline{RD}$、$\\overline{DEN}$，总线周期结束。}\n}\n\\entry{关键状态位}{\n    $S_4, S_3$ 组合指示当前段寄存器：\\red{00:ES, 01:SS, 10:CS, 11:DS}。$S_5$ 指示中断允许标志 $IF$。\n}\n\n}\n\n\\subsubsection{最小方式总线写操作时序}\n\n基本和读操作类似，区别在于数据传输方向相反。\n\n\\imgleft[0.35]{images/image-2025-12-28-20-35-32.png}{\n\n\\concepttable{\n    \\conrow{T1}{输出地址；$ALE$ 发出正脉冲（锁存地址）；$DT/\\overline{R}$ 置高（发送）。}\n    \\conrow{T2}{$\\overline{WR}$ 信号变低（有效）；CPU \\red{直接驱动数据}到 $AD$ 总线（不进入高阻态）。}\n    \\conrow{T3/Tw}{采样 $READY$ 信号；数据在总线上保持稳定，等待外设响应。}\n    \\conrow{T4}{$\\overline{WR}$ \\red{上升沿}触发外设写入数据；撤销 $\\overline{WR}$、$\\overline{DEN}$，周期结束。}\n}\n\\entry{读写区别}{写操作中 $AD$ 总线在 $T_2$ \\red{不进入高阻态}，由 CPU 持续驱动；数据在 $\\overline{WR}$ 上升沿锁存。}\n\n\n}\n\n\\subsubsection{中断时序}\n\n当 CPU 接收到外部中断请求（$INTR$）且中断允许标志 IF=1 时，CPU 会执行一个中断响应操作。这个操作在总线时序上表现为\\red{两个连续的总线周期}。\n\n\\imgleft[0.5]{images/image-2025-12-28-20-38-15.png}{\n\n    \\concepttable{\n        \\conrow{第一周期}{CPU 发出第一个 $\\overline{INTA}$ 负脉冲，用于\\red{中断握手}，此周期不传输数据。}\n        \\conrow{第二周期}{CPU 发出第二个 $\\overline{INTA}$ 负脉冲，8259A 将\\red{中断类型码}送往数据总线 $AD_7 \\sim AD_0$。}\n        \\conrow{后续动作}{CPU 在 $T_4$ 前沿采样类型码，计算向量表地址并跳转至\\red{中断服务程序 (ISR)}。}\n    }\n    \\entry{注意}{两个周期之间可能插入 $T_I$（空闲态）以兼容外设速度。}\n\n}\n\n\\section{第六章 存储系统}\n\n\\subsection{存储器分类与基本指标}\n\n\\subsubsection{分类}\n\n\\concepttable{\n    \\conrow{按读写功能}{\\blue{读写存储器 (RAM)}：可读可写，数据暂存；\n        \\blue{只读存储器 (ROM)}：只能读，存固件/引导程序}\n    \\conrow{按存储介质}{\\blue{半导体存储器}：如 DRAM、ROM，速度快，体积小；\n        \\blue{磁存储器}：如硬盘、磁带，容量大，速度慢}\n    \\conrow{按存取方式}{\\blue{随机存取存储器 (RAM)}：存取时间与位置无关；\n        \\blue{顺序存取存储器}：如磁带，存取时间与位置有关}\n    \\conrow{按信息保存性}{\\blue{易失性存储器}：断电丢失，如 RAM；\n        \\blue{非易失性存储器}：断电保存，如 ROM、硬盘、SSD}\n}\n\n\\textbf{内外存区别：}\n\n\\concepttable{\n    \\conrow{内存}{存放当前运行的程序和数据。特点：\\red{快}、容量小、随机存取，\\red{CPU 可直接通过系统总线访问}。通常由半导体存储器（RAM、ROM）构成。}\n    \\conrow{外存}{存放非当前使用的程序和数据。特点：\\red{慢}、容量大、顺序/块存取，\\red{CPU 不能直接访问}，需通过\\red{I/O 接口电路}调入内存。如硬盘、U 盘、移动硬盘等。}\n}\n\n\\textbf{RAM 类型特点：}\n\n\\concepttable{\n    \\conrow{SRAM}{静态 RAM。利用\\red{双稳态触发器}存储逻辑 0/1，\\red{无需刷新}，只要不掉电信息不丢失。集成度低，外围控制电路简单，常用于小容量存储（如 \\red{Cache}）。}\n    \\conrow{DRAM}{动态 RAM。利用\\red{MOS 管栅极分布电容}存储电荷，\\red{需定期刷新}。集成度高，外围控制电路复杂，常用于大容量存储（如 \\red{主存}）。}\n}\n\n\\concepttable{\n    \\conrow{存储容量}{$N \\times M$ (字数 $\\times$ 字长)}\n    \\conrow{字数 $N$}{单元总数，决定地址线数量 $k$ ($2^k = N$)}\n    \\conrow{字长 $M$}{每单元位数，决定数据线位宽}\n}\n\n\\textbf{常用存储芯片：}\n\n\\concepttable{\n    \\conrow{6264 (S\\red{RAM})}{$8K \\times 8$ (8KB)，13 根地址线 ($2^{13}=8K$)，8 根数据线}\n    \\conrow{2114 (S\\red{RAM})}{$1K \\times 4$，10 根地址线，4 根数据线 (常两片并联组成 8 位)}\n    \\conrow{2764 (EP\\red{ROM})}{$8K \\times 8$ (8KB)，13 根地址线，8 根数据线，用于存储固件}\n}\n\n\\entry{地址译码}{将 CPU 高位地址信号转换为芯片片选信号 \\red{CS\\#}。常用 \\red{74LS138} (3-8 译码器) 实现。}\n\n\\concepttable{\n    \\conrow{Bit (位)}{最小存储单位，对应硬件中的\\red{双稳态触发器}状态。}\n    \\conrow{Byte (字节)}{基本处理单位，\\red{1 B = 8 bits}。}\n    \\conrow{Word (字)}{基本处理单位，\\red{1 Word = 2 Bytes}。}\n    \\conrow{常用容量换算}{1KB=\\red{$2^{10}$}B, 1MB=\\red{$2^{20}$}B, 1GB=\\red{$2^{30}$}B。}\n}\n\\subsubsection{基本性能指标}\n\\concepttable{\n    \\conrow{存取时间}{从 CPU 发出地址信号到数据有效（读）或写入完毕（写）的时间。}\n    \\conrow{存储周期}{进行一次完整读写所需的\\red{最小时间间隔}。}\n    \\conrow{二者关系}{\\red{存储周期 > 存取时间}（内部电路需恢复时间）。}\n    \\conrow{读/写周期}{$t_{cyc}(R)$：连续两次读最小间隔；$t_{cyc}(W)$：连续两次写最小间隔。}\n}\n\n计算末尾地址的公式为：$\\boxed{\\text{末尾地址} = \\text{首地址} + \\text{存储容量} - 1}$ \\textbf{注}：减1是因为地址是从0开始计数的，且首地址本身占用了一个存储单元。\n\n\\subsection{常见芯片}\n\n\\subsubsection{通用引脚特点}\n\n\\concepttable{\n    \\conrow{地址线 $A_0 \\sim A_n$}{接地址总线 $AB$，输入信号，决定芯片容量 $N=2^{n+1}$。}\n    \\conrow{数据线 $D_0 \\sim D_m$}{接数据总线 $DB$，双向（RAM）或输出（ROM），决定字长 $M$。}\n    \\conrow{片选线 $\\overline{CS}/\\overline{CE}$}{由\\red{高位地址译码}产生，低电平有效，用于选中该芯片。}\n    \\conrow{读写线}{读允许 $\\overline{OE}$ 接 CPU 的 $\\overline{RD}$；写允许 $\\overline{WE}$ 接 CPU 的 $\\overline{WR}$。}\n}\n\n\\subsubsection{6264}\n\n\\concepttable{\n    \\conrow{6264 组织}{地址线 \\red{$A_0 \\sim A_{12}$} ($2^{13}=8K$)；数据线 \\red{$D_0 \\sim D_7$}。}\n    \\conrow{双片选机制}{\\red{$\\overline{CS1}$} (低有效) 和 \\red{$CS2$} (高有效)。选中条件：\\red{$\\overline{CS1}=0$} 且 \\red{$CS2=1$}。}\n    \\conrow{读写控制}{\\red{$\\overline{OE}$} (输出允许，接系统 $\\overline{RD}$)；\\red{$\\overline{WE}$} (写允许，接系统 $\\overline{WR}$)。}\n}\n\n\\subsubsection{2114}\n\n\\concepttable{\n    \\conrow{容量与组织}{$1K \\times 4$ 位 ($0.5$ KB)；地址线 \\red{$A_0 \\sim A_9$} ($2^{10}$)，数据线 \\red{$D_1 \\sim D_4$}}\n    \\conrow{位扩展}{8位系统需\\red{两片并联}，分别负责高 4 位和低 4 位}\n}\n\n由于只有一个$\\overline{WE}$而没有$\\overline{OE}$，因此2114 的读写模式由$\\overline{CS}$和$\\overline{WE}$共同决定：\n\n\\concepttable{\n    \\conrow{写模式}{$\\overline{CS}=0, \\overline{WE}=0$，数据端口为输入 (DIN)}\n    \\conrow{读模式}{$\\overline{CS}=0, \\overline{WE}=1$，数据端口为输出 (DOUT)}\n    \\conrow{待机模式}{$\\overline{CS}=1$，输出为\\red{高阻态 (Hi-Z)}，实现总线隔离}\n}\n\n\\subsubsection{2764}\n\n\\concepttable{\n    \\conrow{容量与组织}{地址线 \\red{$A_0 \\sim A_{12}$}；数据线 \\red{$D_0 \\sim D_7$}。与 6264 引脚兼容。}\n    \\conrow{CE\\#}{片选使能，低电平有效。控制芯片激活及低功耗模式。}\n    \\conrow{OE\\#}{输出使能，低电平有效。读操作时打开输出缓冲器。}\n    \\conrow{PGM\\#}{编程脉冲，\\red{低电平有效}。烧录时施加负脉冲，正常读取时置高。}\n    \\conrow{Vpp}{编程电压引脚，烧录时需施加高压（12.5V 或 21V）。}\n}\n\n在对芯片进行数据烧录（编程）时，需要在PGM\\#施加特定宽度（如50ms）的负脉冲，配合$V_{pp}$引脚的高压（通常12.5V或21V），将数据写入\\red{浮栅晶体管}（EPROM没有$\\overline{WE}$引脚，因为它在正常工作时不可写。）\n\n\\hlyellow{低位地址线用于片内寻址，高位地址线用于片选寻址：}\n\n\\img{images/image-2025-12-28-21-02-01.png}\n\n\\subsection{存储器扩展}\n\n\\entry{存储器扩展}{当单片芯片容量（字数 $N$ 或字长 $M$）不足以满足系统需求时，需通过多片组合进行扩展。}\n\n\\concepttable{\n    \\conrow{位扩展}{增加\\red{字长}，字数不变。$N \\times M \\rightarrow N \\times (M \\times k)$。各片\\red{地址线、读写线并联}，数据线分别连接 CPU 数据总线的不同位。}\n    \\conrow{字扩展}{增加\\red{字数}（容量），字长不变。$N \\times M \\rightarrow (N \\times k) \\times M$。各片\\red{数据线、低位地址线并联}，高位地址线经\\red{译码器}产生片选信号 $\\overline{CS}$。}\n    \\conrow{位和字节扩展}{同时增加字长和字数。通常先通过位扩展组成满足字长要求的“存储组”，再通过字扩展（译码片选）连接各组。}\n}\n\n\\subsubsection{位扩展}\n\n当芯片字长小于 CPU 数据总线宽度时，通过多片并联增加\\red{存储字长}。如两片 $1K \\times 4$ 的 2114 并联可组成 $1K \\times 8$ 存储器。\n\n\\imgleft[0.3]{images/image-2025-12-28-21-12-23.png}{\n\n    \\concepttable{\n        \\conrow{地址/片选/读写线}{全部\\red{并联}。所有芯片接收相同地址，由同一片选信号同时选中，并同步执行读/写操作。}\n        \\conrow{数据线（$D_n$）}{\\red{分段连接}。各芯片的数据端分别连接 CPU 数据总线的不同位段（如一片接 $D_0 \\sim D_3$，另一片接 $D_4 \\sim D_7$）。}\n    }\n\n}\n\n\\subsubsection{字节扩展}\n\n当芯片字长满足但容量不足时，增加\\red{存储单元总数}（地址空间深度）。\n\n\\imgleft[0.3]{images/image-2025-12-28-21-19-26.png}{\n\n    \\concepttable{\n        \\conrow{地址线（$A_n$）}{低位地址线全部\\red{并联}，用于片内寻址。}\n        \\conrow{数据线（$D_n$）}{全部\\red{并联}到系统数据总线（与位扩展的区别）。}\n        \\conrow{控制线}{读/写控制信号（$\\overline{OE}, \\overline{WE}$）全部\\red{并联}。}\n        \\conrow{片选线（$\\overline{CS}$）}{高位地址经\\red{译码器}产生，各片\\red{独立连接}，确保同一时刻仅一处有效。}\n    }\n    \\entry{核心逻辑}{通过高位地址译码，将不同芯片映射到系统内存空间的不同地址段（如 $0000H \\sim 1FFFH$）。}\n}\n\n\\subsubsection{位和字节扩展}\n\n当芯片字长和容量均不足时，需同时进行扩展。\n\n\\imgleft[0.3]{images/image-2025-12-28-21-25-45.png}{\n    \\entry{芯片数计算}{所需总芯片数 $Z = (M/L) \\times (N/K)$。其中 $M/L$ 为字扩展组数，$N/K$ 为位扩展组数。L 为单片字长，K 为单片字数。}\n    \\concepttable{\n        \\conrow{第一步：位扩展}{将 $N/K$ 片并联，地址/读写线并联，数据线分段连接，构成一个字长满足要求的存储组（Bank）。}\n        \\conrow{第二步：字扩展}{将 $M/L$ 个存储组级联，数据/低位地址线并联，高位地址经译码器产生各组的片选信号 $\\overline{CS}$。}\n    }\n}\n\n\\subsection{地址译码电路设计（片选）}\n\n\\entry{译码电路设计}{\n    1. \\red{片内寻址}：根据芯片容量 $N$ 确定低位线数 $k$（$2^k=N$），如 4KB 需 $A_{11} \\sim A_0$。\n    2. \\red{片选逻辑}：高位地址通过译码器（如 74LS138）或逻辑门产生 $\\mathrm{CS\\#}$。\n    3. \\red{范围确定}：首地址为高位固定、低位全 0；末地址为高位固定、低位全 1。\n} \n\n\\imgleft[0.3]{images/image-2025-12-28-21-46-21.png}{\n    \\concepttable{\n        \\conrow{全译码}{CPU \\red{全部地址线}均被利用。低位用于片内寻址，\\red{剩余所有高位}参与译码产生片选信号 $\\mathrm{CS\\#}$。特点：地址\\red{唯一性}（不重叠），地址空间连续。}\n        \\conrow{部分译码}{\\red{仅利用部分高位地址}参与译码。存在未使用的“悬空”地址线（Don't Care）。特点：电路简单，但会导致\\red{地址重叠}（镜像），即一个物理单元对应多个逻辑地址。}\n    }\n    \\entry{地址重叠计算}{若有 $n$ 根高位地址线未参与译码，则一个物理单元对应 \\red{$2^n$} 个重叠地址。}\n}\n\n\n\n\n\\subsection{存储器与 CPU 连接}\n\n\\section{第七章\\ I/O接口}\n\n\\subsection{概念}\n\n\\entry{端口}{接口电路中用于缓存数据、状态、及控制信息的部件，分为：\\red{数据端口}、\\red{状态端口}、\\red{控制端口}。}\n\\entry{接口电路}{计算机系统中包含多个不同功能的接口电路，\\red{每个接口电路又可能包含 1 个或多个端口}。}\n\\entry{寻址端口方法}{先找到端口所在的接口电路芯片（\\red{片选}），在该芯片上找到具体要访问的端口（\\red{片内地址}）。若接口中仅有一个端口，则找到芯片即找到端口；若接口中有多个端口，则找到芯片后需再找端口。每个端口地址 = \\red{片选地址（高位地址）} + \\red{片内地址}。}\n\\entry{8086/8088 的 I/O 端口编址}{采用 \\red{I/O 独立编址方式}；I/O 操作只使用 20 根地址线中的 \\red{16 根（A15～A0）}；可寻址的 I/O 端口数为：\\red{$2^{16}=64$K (65536) 个}；I/O 地址范围为：\\red{0～0FFFFH}。}\n\n\\subsection{8259A}\n\\entry{8259A 特性}{\\red{功能}：8259A 是一个功能很强的中断扩充和多中断管理芯片，具有\\red{中断扩展}、\\red{自动提供中断类型码}、\\red{中断优先级裁决}等中断管理功能。\\red{可编程}：内部有多个寄存器以及功能部件都是可编程的，使用方便。\\red{级联扩展}：单片可连接\\red{8 个中断请求源}，多片级联可扩展到\\red{64 级中断}。通过编程可设置\\red{中断触发方式}、\\red{中断类型码}、\\red{中断屏蔽方式}、\\red{中断优先级方式}、\\red{中断结束方式}等。}\n\n\\imgleft[0.4]{images/image-2025-12-25-20-04-51.png}{\n    \\entry{8259A 内部结构}{\n    \\red{数据总线缓冲器}：三态、双向、8 位寄存器。\n    \\red{读写控制逻辑}：接收 CPU 的读写控制信号。\n    \\red{级联缓冲/比较器}：支持单片或多片级联，主片/从片管理，最多可扩展到\\red{64 级中断}。\\par\n    \\red{控制逻辑}：向片内各部件发送控制信号，向 CPU 发送中断请求信号 \\red{INT}，接收 CPU 回送的 \\red{INTA*} 信号，控制 8259A 进入中断管理状态。\\par\n    \\red{中断请求寄存器（IRR）}：8 位寄存器，记录外部中断请求，\\red{IRi} 有请求时 IRR 的相应位 \\red{Di} 置 1，中断响应后清除。\\par\n    \\red{中断屏蔽寄存器（IMR）}：\\red{IMR} 中 \\red{Di} 位为 1 时禁止对应 \\red{IRi} 请求，为 0 时允许。\\par\n    \\red{优先权判决器}：对 IRR 中未屏蔽的中断进行优先级比较，选出当前优先级最高的中断请求。\\par\n    \\red{中断服务寄存器（ISR）}：记录 CPU 当前正在服务的中断标志，\\red{IRi} 请求响应时 ISR 相应位置 1，复位由中断结束方式决定。\n    }\n}\n\n\\section{第八章 常用接口技术}\n\n\\subsection{8255A}\n\n\\entry{8255 功能介绍}{\n        \\red{8255} 是一种\\red{可编程的并行通信接口芯片}，可用于 \\red{CPU} 和外设之间进行并行数据传输。内部有\\red{三个 8 位的数据端口}，有三种工作方式。端口号的 \\red{A0A1} 为 \\red{00}、\\red{01}、\\red{10} 分别表示读写 \\red{A、B、C 口}；\\red{11} 表示只写控制寄存器。\n    }\n\n\\imgleft[0.3]{images/image-2025-12-26-00-05-16.png}{\n    \\entry{并行通信}{\n        指\\red{多位数据同时进行传送}的方式，其特点是\\red{传输速度快}。\n    }\n        \\concepttable{\n            \\conrow{方式 0}{基本的输入/输出方式，A/B/C 口均可用，C 口仅需设置方向。}\n            \\conrow{方式 1}{选通的输入/输出方式，A/B 口可用，支持中断方式传输，C 口部分引脚用于控制和中断信号。}\n            \\conrow{方式 2}{选通的双向传输方式，仅 A 口可用，支持双向传输和中断，C 口部分引脚用于控制和中断信号。}\n        }\n        \\concepttable{\n            \\conrow{A 口}{可工作在方式 0、1、2，方式 2 时支持双向传输。}\n            \\conrow{B 口}{可工作在方式 0、1，仅支持单向传输。}\n            \\conrow{C 口}{只能工作在方式 0，高四位和低四位可分开使用，方式 1/2 时部分引脚用于控制和中断。}\n        }\n}\n\\red{方式 1、2}：选通输入输出方式，可以\\red{中断方式传输}，且\\red{C 口会固定的引脚用作控制联络信号和中断请求信号}。\\par\n\\red{仅 A 口工作在方式 2 时，可以双向传输}，A 口工作在方式 0、1 及 B、C 口只能单向传输。\\par\n\\entry{控制字}{\n    控制字分为端口的\\red{方式选择控制字}（可使 8255 的 3 个数据端口工作在不同的方式）和 C 口的\\red{按位置位和复位控制字}（可使 C 口的任意一位置位和复位）。\n    \\red{★控制字送入的端口为最后一个端口}\n}\n\\vspace{-0.3cm}\n\\begin{center}\n\\begin{tikzpicture}[scale=0.65, every node/.style={font=\\tiny, inner sep=0pt}]\n    % Draw 8 boxes for bits\n    \\foreach \\i in {0,...,7} {\n        \\draw (\\i,0) rectangle ++(1,0.6);\n    }\n    % Bit labels (D7...D0)\n    \\foreach \\i/\\b in {0/D7,1/D6,2/D5,3/D4,4/D3,5/D2,6/D1,7/D0} {\n        \\node at (\\i+0.5,0.3) {\\b};\n    }\n    % Value labels\n    \\node[red] at (0.5,0.85) {1};\n    % Draw a brace and label\n    \\draw [decorate,decoration={brace,amplitude=4pt,mirror},thick] (0,0) -- (8,0) node[midway,below=4pt, font=\\tiny] {方式控制字（8255A）};\n\\end{tikzpicture}\n\\end{center}\n \n\\subsection{8253}\n\n\\entry{概述}{\n    ★\\red{8253} 是一种\\red{可编程的计数器/定时器接口芯片}，最高计数频率为 \\red{$2$MHz}，可用于产生各种\\red{定时波形}，也可用于对\\red{外部事件计数}。内部有\\red{三个独立的 $16$ 位减一计数器}（互不干扰，支持\\blue{二进制 (Binary) }或 \\blue{二-十进制 (BCD码)} 计数），通过设置控制字，各计数器可以工作于 \\red{$6$ 种工作方式}。\n}\n功能简述：\n\n\\imgleft[0.4]{images/image-2025-12-29-14-11-40.png}{\n\n\\concepttable{\n    \\conrow{CLK}{基准信号，即输入的\\red{计数脉冲源}。所有输出变化均以此为时间基准。}\n    \\conrow{OUT1 (定时)}{启动后输出维持一段时间电平后跳变，用于产生确定的\\red{时间延迟}。}\n    \\conrow{OUT2 (分频)}{输入信号频率较高，输出频率较低，输出周期是输入周期的\\red{整数倍}。}\n    \\conrow{OUT3 (方波)}{分频的特殊形式，输出占空比为 \\red{$50\\%$}，形成连续的\\red{方波}。}\n}\n\n}\n\n\\imgleft[0.4]{images/image-2025-12-29-14-06-37.png}{\n\n\\entry{系统总线接口 (连接 CPU)}{\n    \\concepttable{\n        \\conrow{$D_7 \\sim D_0$}{双向数据总线，用于 CPU 读写控制字或计数值。}\n        \\conrow{$\\overline{CS}$}{片选信号，低电平有效，由地址译码电路产生。}\n        \\conrow{$\\overline{RD} / \\overline{WR}$}{读/写信号，低电平有效，控制数据传输方向。}\n        \\conrow{$A_1, A_0$}{端口选择：$00, 01, 10$ 分别对应计数器 $0, 1, 2$；$11$ 为控制寄存器。}\n    }\n}\n\\entry{计数通道信号 (连接外设)}{\n    \\concepttable{\n        \\conrow{$CLK_{0-2}$}{时钟输入，计数脉冲源，\\red{下降沿}触发减 $1$ 操作。}\n        \\conrow{$GATE_{0-2}$}{门控输入，用于启动、停止或暂停计数过程。}\n        \\conrow{$OUT_{0-2}$}{输出信号，计数完成或达到条件时输出特定波形。}\n    }\n}\n\n}\n\n\\entry{控制寄存器}{只能进行\\red{写操作}，不能读。CPU 通过向此寄存器写入“控制字”来设定各通道的工作方式。}\n\n\\entry{计数通道结构}{包含三个独立的计数通道（0、1、2），内部由以下三部分配合实现“预置 $\\rightarrow$ 减计数 $\\rightarrow$ 读出”逻辑：}\n\\concepttable{\n    \\conrow{初值寄存器 (CR)}{\\red{16 位}。用于预置计数的起始值。}\n    \\conrow{执行部件 (CE)}{\\red{16 位减法计数器}。在 $CLK$ 信号驱动下进行减 1 计数。}\n    \\conrow{输出锁存器 (OL)}{\\red{16 位}。用于锁存当前计数值供 CPU 读取，不影响计数进行。}\n}\n\n\\red{8253 没有状态寄存器}，CPU \\red{无法直接读取}状态寄存器来获知当前工作状态或回读控制字。这与具有状态回读功能的 \\red{8254} 不同。\n\n\\noindent\n\\begin{minipage}[t]{0.38\\linewidth}\n    \\entry{端口地址分配}{8253 占用 4 个 I/O 端口。CPU 通过 $A_1, A_0$ 选择：}\n    \\concepttable{\n        \\conrow{00}{计数通道 0}\n        \\conrow{01}{计数通道 1}\n        \\conrow{10}{计数通道 2}\n        \\conrow{11}{控制字寄存器}\n    }\n\\end{minipage}\n\\hfill\n\\begin{minipage}[t]{0.58\\linewidth}\n    \\entry{读写物理寄存器}{读写指向不同物理寄存器：}\n    \\concepttable{\n        \\conrow{写 (OUT)}{送入 \\red{初值寄存器 (CR)}。}\n        \\conrow{读 (IN)}{来自 \\red{输出锁存器 (OL)}。}\n    }\n    \\tiny 这种“双缓冲”设计保证计数时读数稳定。\n\\end{minipage}\n\\par\\vspace{2pt}\n\n\\noindent\n\\begin{minipage}[t]{0.49\\linewidth}\n    \\entry{实例 1：连续地址 (8088)}{\n        \\concepttable{\n            \\conrow{设定}{地址范围：$0380H \\sim 0383H$。地址连续（步长为 1）。}\n            \\conrow{分析}{$0380H (\\dots 00) \\rightarrow A_1A_0 = 00$ \\par $0381H (\\dots 01) \\rightarrow A_1A_0 = 01$ \\par $0382H (\\dots 10) \\rightarrow A_1A_0 = 10$ \\par $0383H (\\dots 11) \\rightarrow A_1A_0 = 11$}\n            \\conrow{连接}{CPU 的 $A_1, A_0$ 直接连接到 8253 的 $A_1, A_0$。每一个逻辑地址都对应一个物理端口，无地址间隙。}\n        }\n    }\n\\end{minipage}\n\\hfill\n\\begin{minipage}[t]{0.49\\linewidth}\n    \\entry{实例 2：偶地址对齐 (8086)}{\n        \\concepttable{\n            \\conrow{设定}{地址序列：$0380H, 0382H, \\sim 0386H$ \\par 只使用偶数地址。}\n            \\conrow{分析}{$0380H (\\dots 00 \\mathbf{0}) \\rightarrow A_2A_1 = 00$；$0382H (\\dots 01 \\mathbf{0}) \\rightarrow A_2A_1 = 01$；$0384H (\\dots 10 \\mathbf{0}) \\rightarrow A_2A_1 = 10$；$0386H (\\dots 11 \\mathbf{0}) \\rightarrow A_2A_1 = 11$。}\n            \\conrow{连接}{CPU $A_0$ 恒为 0。CPU 的 $A_2, A_1$ 错位连接到 8253 的 $A_1, A_0$。配合 16 位数据总线字节对齐要求。}\n        }\n    }\n\\end{minipage}\n\n\\entry{读/写逻辑真值表}{\n    \\concepttable{\n        \\conrow{片选前提}{所有操作必须在 $\\overline{CS}=0$ 时有效。}\n        \\conrow{写 ($\\overline{WR}=0$)}{根据 $A_1, A_0$ 写入通道 0/1/2 的计数初值寄存器，或写入控制字寄存器。}\n        \\conrow{读 ($\\overline{RD}=0$)}{根据 $A_1, A_0$ 读取通道 0/1/2 的当前计数值。注意：\\red{控制字寄存器只写不读}。}\n    }\n}\n\n\\entry{8 位总线与 16 位计数器接口}{\n    8253 内部的计数初值寄存器 (CR) 和输出锁存器 (OL) 都是 16 位的，但外部数据总线 ($D_7 \\sim D_0$) 只有 8 位。必须通过\\red{两次 I/O 操作}来完成一个 16 位数据的传输，由控制寄存器中的控制字来指定读写顺序（如：先读/写低 8 位，再读/写高 8 位）。\n}\n\n\\subsubsection{控制字}\n\n\\begin{center}\n\\begin{tikzpicture}[scale=0.65, every node/.style={font=\\tiny, inner sep=0pt}]\n    % Draw 8 boxes for bits\n    \\foreach \\i in {0,...,7} {\n        \\draw (\\i,0) rectangle ++(1,0.6);\n    }\n    % Bit labels (D7...D0)\n    \\foreach \\i/\\b in {0/D7,1/D6,2/D5,3/D4,4/D3,5/D2,6/D1,7/D0} {\n        \\node at (\\i+0.5,0.3) {\\b};\n    }\n    % Function labels\n    \\node at (0.5,0.85) {SC1}; \\node at (1.5,0.85) {SC0};\n    \\node at (2.5,0.85) {RL1}; \\node at (3.5,0.85) {RL0};\n    \\node at (4.5,0.85) {M2};  \\node at (5.5,0.85) {M1}; \\node at (6.5,0.85) {M0};\n    \\node at (7.5,0.85) {BCD};\n    \n    % Braces\n    \\draw [decorate,decoration={brace,amplitude=3pt},thick] (0,1) -- (2,1) node[midway,above=2pt] {计数器选择};\n    \\draw [decorate,decoration={brace,amplitude=3pt},thick] (2,1) -- (4,1) node[midway,above=2pt] {读写操作};\n    \\draw [decorate,decoration={brace,amplitude=3pt},thick] (4,1) -- (7,1) node[midway,above=2pt] {工作方式};\n    \\draw [decorate,decoration={brace,amplitude=3pt},thick] (7,1) -- (8,1) node[midway,above=2pt] {计数制};\n    \n    % Bottom label\n    \\node at (4,-0.4) {8253 控制字格式};\n\\end{tikzpicture}\n\\end{center}\n\n\\concepttable{\n    \\conrow{$SC_1, SC_0$}{\n        \\textbf{计数器选择}。因共用端口（3 个计数器共用一个控制端口），需指定目标通道。\\par\n        \\red{00}: CNT0; \\red{01}: CNT1; \\red{10}: CNT2; \\red{11}: 非法。\n    }\n    \\conrow{$RL_1, RL_0$}{\n        \\textbf{读写格式}。定义 CR/OL 的读写位宽及顺序。\\par\n        \\red{00}: \\textbf{锁存命令} (不停止计数读取); \\red{01}: 仅低8位; \\red{10}: 仅高8位; \\red{11}: \\textbf{先低后高} (16位常用)。\n    }\n    \\conrow{$M_2 \\sim M_0$}{\n        \\textbf{工作方式}。设定方式 0 $\\sim$ 5。\n    }\n    \\conrow{$BCD$}{\n        \\textbf{计数制}。\\red{0}: 二进制 ($FFFFH$); \\red{1}: BCD码 ($9999$)。\n    }\n}\n\n\\noindent\n\\begin{minipage}[t]{0.49\\linewidth}\n    \\entry{实例 1：8 位读写模式}{\n        \\blue{需求}：计数器 0，方式 2，仅使用低 8 位，初值 100，二进制计数。地址：$70H \\sim 73H$。\n    }\n    \\concepttable{\n        \\conrow{SC}{\\red{00} (选择计数器 0)}\n        \\conrow{RL}{\\red{01} (只读/写低 8 位)}\n        \\conrow{M}{\\red{010} (方式 2，分频器)}\n        \\conrow{BCD}{\\red{0} (二进制计数)}\n        \\conrow{控制字}{$00010100B = \\red{14H}$}\n    }\n    \\blue{汇编实现}：\n    \\begin{itemize}\n        \\item \\texttt{MOV AL, 14H}\n        \\item \\texttt{OUT 73H, AL \\ \\ ;写控制字}\n        \\item \\texttt{MOV AL, 100 \\ \\ ;初值 100}\n        \\item \\texttt{OUT 70H, AL \\ \\ ;写低 8 位}\n    \\end{itemize}\n\\end{minipage}\n\\hfill\n\\begin{minipage}[t]{0.49\\linewidth}\n    \\entry{实例 2：16 位读写模式}{\n        \\blue{需求}：计数器 1，方式 1，16 位 (先低后高)，初值 1234，BCD 码。地址：$70H \\sim 73H$。\n    }\n    \\concepttable{\n        \\conrow{SC}{\\red{01} (选择计数器 1)}\n        \\conrow{RL}{\\red{11} (先低 8 位后高 8 位)}\n        \\conrow{M}{\\red{001} (方式 1，单稳态)}\n        \\conrow{BCD}{\\red{1} (BCD 码计数)}\n        \\conrow{控制字}{$01110011B = \\red{73H}$}\n    }\n    \\blue{汇编实现}：\n    \\begin{itemize}\n        \\item \\texttt{MOV AL, 73H}\n        \\item \\texttt{OUT 73H, AL \\ \\ ;写控制字}\n        \\item \\texttt{MOV AX, 1234H \\ ;BCD 码初值}\n        \\item \\texttt{OUT 71H, AL \\ \\ ;写低 8 位}\n        \\item \\texttt{MOV AL, AH}\n        \\item \\texttt{OUT 71H, AL \\ \\ ;写高 8 位}\n    \\end{itemize}\n\\end{minipage}\n\n\\entry{锁存命令}{解决在计数器运行过程中读取数值不稳定的问题。通过向控制寄存器写入 $RL_1RL_0 = 00$ 的控制字，将当前计数值复制到 \\red{输出锁存器 (OL)} 中保持不变，而 \\red{执行部件 (CE)} 继续计数。}\n\n\\entry{锁存读出示例}{\n    \\concepttable{\n    \\conrow{锁存机制}{向控制口发送控制字，其中 $RL_1RL_0 = 00$。8253 接收后锁存当前值，不影响内部计数。}\n    \\conrow{实例分析}{读取计数器 0 当前值：$SC=00, RL=00$，其余位无关，控制字为 \\red{00H}。}\n    \\conrow{代码流程}{\n        1. \\texttt{MOV AL, 00H} \\par\n        2. \\texttt{OUT 73H, AL} (向控制口发送锁存命令) \\par\n        3. \\texttt{IN AL, 70H} (从数据口读取低 8 位) \\par\n        4. \\texttt{IN AL, 70H} (从数据口读取高 8 位)\n    }\n    \\conrow{注意}{读出操作必须符合初始化时设定的 \\red{RL} 格式（如 16 位模式需连读两次）。}\n    }\n}\n\n\\entry{相关名词解释}{\n    \\concepttable{\n    \\conrow{CLK 脉冲}{指 \\red{CLK} 引脚上的信号单元。在计数过程中，每一个 \\red{CLK} 脉冲的\\red{下降沿}到来时，计数器减 1。}\n    \\conrow{计数器}{与“计数通道”同义}\n    \\conrow{时常数}{指通过指令写入计数器的值，等同于\\red{初值}。输出波形的周期或延时由该值决定：$\\text{时间} = \\text{初值} \\times T_{CLK}$。}\n    }\n}\n\n\\subsubsection{方式 0}\n\n\\entry{功能定义}{\n    主要用于\\red{定时中断}。给定时间 $t_0$，到达后输出信号通知 CPU。\n}\n\n\\noindent\n\\begin{minipage}[t]{0.55\\linewidth}\n    \\concepttable{\n        \\conrow{初始化}{写入方式控制字后，输出引脚 \\red{OUT 变为低电平}。}\n        \\conrow{计数过程}{写入初值后开始减 1 计数，期间 \\red{OUT 保持低电平}。}\n        \\conrow{计数结束}{当计数值减到 0 时，\\red{OUT 立即跳变为高电平}。产生的\\red{上升沿信号}通常连接 CPU 中断请求引脚。}\n    }\n\\end{minipage}%\n\\hfill\n\\begin{minipage}[t]{0.44\\linewidth}\n    \\red{GATE} 是硬件门控信号，在方式 0 中充当“计数使能开关”：\n    \n    \\concepttable{\n        \\conrow{0}{暂停计数，计数器保持当前值不变，忽略 CLK 脉冲。}\n        \\conrow{1}{允许计数，计数器正常工作。}\n    }\n\\end{minipage}\n\n\\imgleft[0.4]{images/image-2025-12-29-15-24-32.png}{\n    \\entry{时序分析 (基本过程)}{\n        重点在于 \\red{$N+1$} 个时钟周期的由来。\n        \\concepttable{\n            \\conrow{写入控制字}{$\\overline{WR}$ 有效 $\\to$ \\red{OUT 变低} (起始状态)。}\n            \\conrow{写入初值}{第二个 $\\overline{WR}$ 将初值 $N$ 写入 CR。}\n            \\conrow{载入时刻}{写入后第 1 个 CLK 下降沿，数据 CR $\\to$ CE。}\n            \\conrow{计数过程}{载入后开始减 1 ($N \\to 0$)。总时长 \\red{$N+1$} 个 CLK。}\n            \\conrow{终值输出}{CE 减为 0 时，\\red{OUT 变高}。}\n        }\n    }\n}\n\n\\imgleft[0.4]{images/image-2025-12-29-15-19-48.png}{\n    \\entry{GATE 控制 (暂停)}{\n        \\concepttable{\n            \\conrow{GATE=0}{暂停计数 (CE 保持)，OUT 保持低。}\n            \\conrow{GATE=1}{恢复计数 (从暂停值继续)。}\n        }\n    }\n    \\entry{结论}{利用 GATE 可\\red{加长 OUT 低电平宽度}。实际时间 = 预置 + 暂停。}\n}\n\n\\imgleft[0.4]{images/image-2025-12-29-15-22-52.png}{\n    \\entry{重写初值 (重启动)}{\n        若在计数未结束时写入新初值，8253 会放弃当前进程，在下一个 CLK \\red{重新装入新初值并重新开始}。同样实现了\\red{加长 OUT 低电平宽度}的效果。\n    }\n    \\entry{周期数}{写入时常数为 $N$ 时，OUT 低电平宽度为 \\red{$N+1$} 个 CLK 周期。}\n    \\entry{计数完成后}{CE 寄存器会变成FFFFH，OUT（OL 锁存器）一直输出高电平，但是 CE 持续在-1 计数}\n}\n\n\\entry{方式 0 编程示例}{\n    已知端口 $40H \\sim 43H$，计数器 0，方式 0，初值 1500，二进制计数。\n}\n\\concepttable{\n    \\conrow{控制字}{SC=00, RL=11, M=000, BCD=0 $\\to$ \\red{30H}}\n    \\conrow{时常数}{$1500 = 05DCH$ (低位 \\red{DCH}，高位 \\red{05H})}\n}\n\\blue{汇编实现}：\n\\begin{itemize}\n    \\item \\texttt{MOV DX, 43H \\ \\ ;指向控制口}\n    \\item \\texttt{MOV AL, 30H \\ \\ ;写控制字}\n    \\item \\texttt{OUT DX, AL}\n    \\item \\texttt{MOV DX, 40H \\ \\ ;指向计数器 0 数据口}\n    \\item \\texttt{MOV AX, 1500 \\ ;AX = 05DCH}\n    \\item \\texttt{OUT DX, AL \\ \\ ;写低 8 位 (DCH)}\n    \\item \\texttt{MOV AL, AH \\ \\ ;取高 8 位 (05H)}\n    \\item \\texttt{OUT DX, AL \\ \\ ;写高 8 位}\n\\end{itemize}\n\\entry{核心逻辑}{\n    写初值 $\\to$ OUT 低 $\\to$ 计数 $\\to$ 0 $\\to$ OUT 高。\\red{定时时长 $= (N+1) \\times T_{CLK}$。}可通过 GATE 硬件信号暂停，或重写初值延长定时。\n}\n\n\\subsubsection{方式 1}\n\n\\entry{功能定义}{\n    \\red{单脉冲形成}。即产生一个宽度可控的\\red{负脉冲}。\n\n    \\concepttable{\n        \\conrow{触发源}{\\red{硬件触发}。区别于方式 0 的软件写入触发，方式 1 必须由 \\red{GATE} 引脚的\\red{上升沿}（由低电平变高电平）来触发。}\n        \\conrow{脉冲宽度}{输出负脉冲的宽度为 \\red{$N \\times T_{CLK}$}，其中 $N$ 为预置的初值。}\n    }\n\n}\n\n\\imgleft[0.4]{images/image-2025-12-29-15-43-06.png}{\n\n    \\concepttable{\n        \\conrow{初始化}{写入方式控制字后 \\red{OUT 变高}；写入初值后 OUT 保持高电平。}\n        \\conrow{触发时刻}{\\red{GATE 上升沿}触发。在随后的下一个 CLK 下降沿，OUT 由高变低。}\n        \\conrow{计数与结束}{计数器减 1 期间 OUT 为低；减至 0 时 OUT 跳变为高。低电平宽度 $= N \\times T_{CLK}$。}\n    }\n    \\entry{可重触发性}{\n        在脉冲未结束时，若 \\red{GATE 再次出现上升沿}，8253 会在下一个 CLK 将初值寄存器 (CR) 的值\\red{重新装入}执行单元 (CE)，使计数器重新开始，从而\\red{延长 OUT 低电平宽度}。\n    }\n\n}\n\n\\imgleft[0.4]{images/image-2025-12-29-15-43-35.png}{\n\n\\entry{修改初值 (方式 1)}{在脉冲输出过程中，若 CPU 修改计数初值：}\n\\concepttable{\n    \\conrow{系统响应}{新初值 $N_{new}$ 仅存入 \\red{初值寄存器 (CR)}。当前计数器 (CE) 不受影响，继续按旧值 $N_{old}$ 减至 0，当前脉冲宽度不变。}\n    \\conrow{生效时刻}{仅在 \\red{下一次 GATE 上升沿} 到来时，新值 $N_{new}$ 才从 CR 装入 CE。}\n    \\conrow{结论}{写入新初值\\red{不会立即重启}计数，而是预置给下一次触发使用。}\n}\n\n}\n\n\n\\noindent{\\setlength{\\tabcolsep}{2pt}\n    \\begin{tabular}{@{}p{0.48\\linewidth}|p{0.48\\linewidth}@{}}\n    \\hline\n    \\centering \\blue{方式 0 (软件触发)} & \\centering \\blue{方式 1 (硬件触发)} \\tabularnewline \\hline\n    写初值操作直接启动计数 & GATE 上升沿触发启动 \\\\\n    GATE \\red{电平}敏感：1 计数，0 暂停 & GATE \\red{边沿}敏感：上升沿重触发 \\\\\n    低电平宽度为 \\red{$N+1$} 个 CLK & 低电平宽度为 \\red{$N$} 个 CLK \\\\ \\hline\n    \\end{tabular}}\n    \\concepttable{\n    \\conrow{相同点}{均为减 1 计数；工作时输出低电平；均具备定时功能。}\n}\n\n\\noindent\n\\begin{minipage}[t]{0.49\\linewidth}\n    \\entry{实例 1-单一通道编程}{\\par\n        \\blue{需求}：计数器 2，方式 1，初值 15，仅低 8 位。地址：控制口 \\red{COUNTD}，计数器 2 \\red{COUNTC}。\n    }\n    \\concepttable{\n        \\conrow{控制字}{$SC=10, RL=01, M=001, BCD=0 \\to \\red{92H}$}\n        \\conrow{汇编实现}{\n            \\texttt{MOV AL, 92H} \\par\n            \\texttt{OUT COUNTD, AL \\ ;写控制字} \\par\n            \\texttt{MOV AL, 15} \\par\n            \\texttt{OUT COUNTC, AL \\ ;写初值}\n        }\n    }\n\\end{minipage}\n\\hfill\n\\begin{minipage}[t]{0.49\\linewidth}\n    \\entry{实例 2-波形分析与混合}{\\par\n        \\blue{需求}：根据波形反推。OUT0 为方式 0，OUT1 为方式 1。初值均为 7。\n    }\n    \\concepttable{\n        \\conrow{CNT0 控制字}{$SC=00, RL=01, M=000 \\to \\red{10H}$}\n        \\conrow{CNT1 控制字}{$SC=01, RL=01, M=001 \\to \\red{52H}$}\n        \\conrow{汇编实现}{\n            \\texttt{MOV AL, 10H; OUT COUNTD, AL} \\par\n            \\texttt{MOV AL, 52H; OUT COUNTD, AL} \\par\n            \\texttt{MOV AL, 7} \\par\n            \\texttt{OUT COUNTA, AL \\ ;CNT0 初值} \\par\n            \\texttt{OUT COUNTB, AL \\ ;CNT1 初值}\n        }\n    }\n\\end{minipage}\n\n% --- 手动换栏命令（如果需要强制换列）---\n% \\columnbreak \n\n\\end{multicols*}\n\n\\end{document}"
        }
    ]
}